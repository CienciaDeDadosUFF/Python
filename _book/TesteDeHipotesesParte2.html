<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>APRENDIZADO DE MÁQUINA COM PYTHON - Teste de Hipóteses - Parte 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./TesteDeHipotesesParte1.html" rel="prev">
<link href="./uff-brasao.jpg" rel="icon" type="image/jpeg">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./TesteDeHipotesesParte2.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Teste de Hipóteses - Parte 2</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">APRENDIZADO DE MÁQUINA COM PYTHON</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/CienciaDeDadosUFF/cienciadedadosuff.github.io" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./APRENDIZADO-DE-MÁQUINA-COM-PYTHON.pdf" rel="" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Apresentação</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./caderno1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introdução a programação com Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./caderno2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Aprofundamento em programação com Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ConceitosGeraisDeEstatistica.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Conceitos Gerais de Estatística</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./VisualizacaoDeDados.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Visualização de Dados</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./EstimativaPorIntervalos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Estimativa por Intervalos</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TesteDeHipotesesParte1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Teste de Hipóteses - Parte 1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TesteDeHipotesesParte2.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Teste de Hipóteses - Parte 2</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Navegação</h2>
   
  <ul>
  <li><a href="#importação" id="toc-importação" class="nav-link active" data-scroll-target="#importação">Importação</a></li>
  <li><a href="#inferência-sobre-três-ou-mais-populações" id="toc-inferência-sobre-três-ou-mais-populações" class="nav-link" data-scroll-target="#inferência-sobre-três-ou-mais-populações">Inferência sobre Três ou mais Populações</a></li>
  <li><a href="#teste-de-levene" id="toc-teste-de-levene" class="nav-link" data-scroll-target="#teste-de-levene">Teste de Levene</a>
  <ul class="collapse">
  <li><a href="#exemplo" id="toc-exemplo" class="nav-link" data-scroll-target="#exemplo">Exemplo</a></li>
  </ul></li>
  <li><a href="#teste-one-way-anova" id="toc-teste-one-way-anova" class="nav-link" data-scroll-target="#teste-one-way-anova">Teste One-Way ANOVA</a>
  <ul class="collapse">
  <li><a href="#exemplo-1" id="toc-exemplo-1" class="nav-link" data-scroll-target="#exemplo-1">Exemplo</a></li>
  </ul></li>
  <li><a href="#teste-de-shapiro-wilk" id="toc-teste-de-shapiro-wilk" class="nav-link" data-scroll-target="#teste-de-shapiro-wilk">Teste de Shapiro-Wilk</a>
  <ul class="collapse">
  <li><a href="#exemplo-2" id="toc-exemplo-2" class="nav-link" data-scroll-target="#exemplo-2">Exemplo</a></li>
  </ul></li>
  <li><a href="#teste-de-kolmogorovsmirnov" id="toc-teste-de-kolmogorovsmirnov" class="nav-link" data-scroll-target="#teste-de-kolmogorovsmirnov">Teste de Kolmogorov–Smirnov</a>
  <ul class="collapse">
  <li><a href="#exemplo-1-1" id="toc-exemplo-1-1" class="nav-link" data-scroll-target="#exemplo-1-1">Exemplo 1</a></li>
  <li><a href="#exemplo-2-1" id="toc-exemplo-2-1" class="nav-link" data-scroll-target="#exemplo-2-1">Exemplo 2</a></li>
  </ul></li>
  <li><a href="#análise-sobre-dados-categóricos" id="toc-análise-sobre-dados-categóricos" class="nav-link" data-scroll-target="#análise-sobre-dados-categóricos">Análise sobre Dados Categóricos</a>
  <ul class="collapse">
  <li><a href="#teste-de-aderência" id="toc-teste-de-aderência" class="nav-link" data-scroll-target="#teste-de-aderência">Teste de Aderência</a>
  <ul class="collapse">
  <li><a href="#exemplo-3" id="toc-exemplo-3" class="nav-link" data-scroll-target="#exemplo-3">Exemplo</a></li>
  </ul></li>
  <li><a href="#teste-de-homogeneidade" id="toc-teste-de-homogeneidade" class="nav-link" data-scroll-target="#teste-de-homogeneidade">Teste de Homogeneidade</a>
  <ul class="collapse">
  <li><a href="#exemplo-4" id="toc-exemplo-4" class="nav-link" data-scroll-target="#exemplo-4">Exemplo</a></li>
  </ul></li>
  <li><a href="#teste-de-independência" id="toc-teste-de-independência" class="nav-link" data-scroll-target="#teste-de-independência">Teste de Independência</a>
  <ul class="collapse">
  <li><a href="#exemplo-5" id="toc-exemplo-5" class="nav-link" data-scroll-target="#exemplo-5">Exemplo</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#referências" id="toc-referências" class="nav-link" data-scroll-target="#referências">Referências</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/CienciaDeDadosUFF/cienciadedadosuff.github.io/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Teste de Hipóteses - Parte 2</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><img src="Cadernos Grupo Python/Teste de Hipóteses - Parte 2/inicio.png" class="img-fluid"></p>
<section id="importação" class="level1">
<h1>Importação</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.stats <span class="im">as</span> sm</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.weightstats <span class="im">import</span> ztest</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.stats <span class="im">as</span> ss</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.sandbox.stats.multicomp <span class="im">import</span> tukeyhsd</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.weightstats <span class="im">import</span> ttest_ind</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> chisquare</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> chi2_contingency</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="inferência-sobre-três-ou-mais-populações" class="level1">
<h1>Inferência sobre Três ou mais Populações</h1>
</section>
<section id="teste-de-levene" class="level1">
<h1>Teste de Levene</h1>
<p>Teste de Levene é usado para testar se k amostras foram coletadas de populações que possuem mesma variância. As hipóteses do teste são:</p>
<p><code>(?)</code></p>
<p>vs</p>
<p><code>(?)</code></p>
<p>Ou seja, igualdade entre as variâncias populacionais contra a alternativa de que nem todas as variâncias são iguais. Ele é o teste mais robusto contra falta de normalidade dos dados e sua estatística de teste segue com uma distribuição F sob <span class="math inline">\(H_{0}\)</span>:</p>
<p><span class="math inline">\(L = \frac{(n-k)\sum_{i=1}^{k}n_{i}(\bar{Z_{i.}}-\bar{Z_{..}})^{2}}{(k-1)\sum_{i=1}^{k}\sum_{j=1}^{n_{i}}(Z_{ij}-\bar{Z_{i.}})^{2}} \sim F_{k-1,n-k}\)</span></p>
<p>em que</p>
<p><code>(?)</code></p>
<p>é o desvio absoluto dos <span class="math inline">\(X_{ij}\)</span> em relação à média de cada grupo. Já</p>
<p><span class="math inline">\(\bar{Z_{i.}}=\sum_{j=1}^{n_{i}}Z_{ij}\)</span></p>
<p>é a média dos <span class="math inline">\(Z_{i,j}\)</span> no grupo i. E</p>
<p><code>(?)</code></p>
<p>é a média geral dos <span class="math inline">\(Z_{i,j}\)</span></p>
<p>O p-valor é calculado da forma:</p>
<p><span class="math inline">\(p-valor= P(F&gt;L_{obs}\mid H_{0})\)</span></p>
<p>Para aplicarmos o teste de Levene, utilizamos a função <code>levene</code> da biblioteca Scipy, cujos argumentos de entrada são:</p>
<ul>
<li><code>sample1</code>, <code>sample2</code>, … : amostras observadas.</li>
<li><code>center</code>: há três opções: “mean”, “median” ou “trimmed”. Para o caso da população seguir uma normal, utilize “mean”.</li>
</ul>
<p>Para mais informações clique aqui para acessar a documentação da função.</p>
<p>Como a maioria das funções, essa retorna o valor da estatística de teste e o p-valor.</p>
<p>Para aplicação do teste utilizaremos o banco de dados de uma amostra aleatória simples de avaliações de filmes do site Rotten Tomatoes. Vamos supor que os dados são provenientes de distribuições normais.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'Movie-Ratings.csv'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="dataframe table-striped table-bordered table-sm table small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Film</th>
<th data-quarto-table-cell-role="th">Genre</th>
<th data-quarto-table-cell-role="th">Rotten Tomatoes Ratings %</th>
<th data-quarto-table-cell-role="th">Audience Ratings %</th>
<th data-quarto-table-cell-role="th">Budget (million $)</th>
<th data-quarto-table-cell-role="th">Year of release</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>(500) Days of Summer</td>
<td>Comedy</td>
<td>87</td>
<td>81</td>
<td>8</td>
<td>2009</td>
</tr>
<tr class="even">
<td>1</td>
<td>10,000 B.C.</td>
<td>Adventure</td>
<td>9</td>
<td>44</td>
<td>105</td>
<td>2008</td>
</tr>
<tr class="odd">
<td>2</td>
<td>12 Rounds</td>
<td>Action</td>
<td>30</td>
<td>52</td>
<td>20</td>
<td>2009</td>
</tr>
<tr class="even">
<td>3</td>
<td>127 Hours</td>
<td>Adventure</td>
<td>93</td>
<td>84</td>
<td>18</td>
<td>2010</td>
</tr>
<tr class="odd">
<td>4</td>
<td>17 Again</td>
<td>Comedy</td>
<td>55</td>
<td>70</td>
<td>20</td>
<td>2009</td>
</tr>
</tbody>
</table>
<section id="exemplo" class="level2">
<h2 class="anchored" data-anchor-id="exemplo">Exemplo</h2>
<p>Deseja-se saber se a variabilidade das notas dos críticos do site Rotten Tomatoes são <code>iguais</code> nos filmes dos gêneros <strong>Comédia, Ação, Aventura e Drama</strong>, ao nível de significância de <code>5%</code>.</p>
<p><code>(?)</code></p>
<p>vs</p>
<p><code>(?)</code></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df_acao, df_adventure, df_comedia, df_drama <span class="op">=</span> df[df[<span class="st">"Genre"</span>] <span class="op">==</span> <span class="st">'Action'</span>], df[df[<span class="st">"Genre"</span>] <span class="op">==</span> <span class="st">'Adventure'</span>], df[df[<span class="st">"Genre"</span>] <span class="op">==</span> <span class="st">"Comedy"</span>], df[df[<span class="st">"Genre"</span>]<span class="op">==</span><span class="st">"Drama"</span>]</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>ss.levene(df_acao[<span class="st">'Rotten Tomatoes Ratings %'</span>],df_adventure[<span class="st">'Rotten Tomatoes Ratings %'</span>], df_drama[<span class="st">'Rotten Tomatoes Ratings %'</span>], df_comedia[<span class="st">'Rotten Tomatoes Ratings %'</span>], center<span class="op">=</span><span class="st">"mean"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>LeveneResult(statistic=1.6923208903592077, pvalue=0.16786851919967521)</p>
</div>
</div>
</div>
<p>Como p-valor=0.16 é maior que o nível de significância proposto, não rejeitamos a hipótese nula, ou seja, há evidências de que as variâncias das avaliações dos filmes dos gêneros Comédia, Ação, Drama e Aventura são iguais.</p>
</section>
</section>
<section id="teste-one-way-anova" class="level1">
<h1>Teste One-Way ANOVA</h1>
<p>A One-Way ANOVA é usada para testar diferenças entre médias de pelo menos três populações, uma vez que a comparação entre dois grupos pode ser obtida através do teste t. Assim como no caso do teste t, o modelo da ANOVA exige que as populações possuam distribuição Normal e, além disso, as variâncias devem ser <strong>iguais</strong>. Considere que são extraídas amostras aleatórias simples de tamanhos <span class="math inline">\(n_{1},n_{2},\ldots,n{k}\)</span> dessas populações. A hipótese de interesse é</p>
<p><span class="math inline">\(H_{0} : \mu_{1} = \mu_{2} = \ldots = \mu_{k}\)</span></p>
<p>vs</p>
<p><span class="math inline">\(H_{1} : \mu_{i} \neq \mu_{j}\)</span> para algum <span class="math inline">\(i\neq j\)</span>.</p>
<p>com a hipótese alternativa sendo que pelo menos uma das médias é considerada diferente.</p>
<p>A estatística de teste é dada por:</p>
<p><code>(?)</code></p>
<p>onde</p>
<p><code>(?)</code></p>
<p>e</p>
<p><code>(?)</code></p>
<p>O p-valor é calculado da forma:</p>
<p><span class="math inline">\(p-valor= P(F&gt;F_{obs}\mid H_{0})\)</span></p>
<p>Para aplicarmos o teste One Way ANOVA utilizamos a função <code>f_oneway</code> da biblioteca <strong>Scipy</strong>, cujos argumentos de entrada são apenas:</p>
<ul>
<li><code>sample1</code>, <code>sample2</code>, … : amostras observadas.</li>
</ul>
<p>Para mais informações clique aqui para acessar a documentação da função.</p>
<p>Vamos exemplificar a utilização do teste com o banco de dados de avaliações de filmes.</p>
<section id="exemplo-1" class="level2">
<h2 class="anchored" data-anchor-id="exemplo-1">Exemplo</h2>
<p>Deseja-se verificar se as médias dos avaliações do site Rotten Tomatoes são <code>iguais</code> para os filmes de <strong>Ação, Comédia, Drama e Aventura</strong>, utilizando um nível de significância de <code>5%</code>.</p>
<p><span class="math inline">\(H_{0} : \mu_{Ação} = \mu_{Comédia} = \mu_{Drama} = \mu_{Aventura}\)</span></p>
<p>vs</p>
<p><span class="math inline">\(H_{1} : \mu_{i} \neq \mu_{j}\)</span> para algum <span class="math inline">\(i \neq j, \space\space\space onde \space i,j = {Ação,Aventura,Comédia,Drama}\)</span></p>
<p>Primeiro passo a ser realizado é verificar se as variâncias são iguais, aplicando o Teste de Levene. Logo, através da aplicação no exemplo anterior, temos que as variâncias são consideradas <strong>iguais</strong>. Agora realizaremos o teste de ANOVA.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>ss.f_oneway(df_acao[<span class="st">'Rotten Tomatoes Ratings %'</span>],df_adventure[<span class="st">'Rotten Tomatoes Ratings %'</span>],df_drama[<span class="st">'Rotten Tomatoes Ratings %'</span>], df_comedia[<span class="st">'Rotten Tomatoes Ratings %'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>F_onewayResult(statistic=6.039948218319176, pvalue=0.0004869684243719264)</p>
</div>
</div>
</div>
<p>Como p-valor é menor que o nível de significância proposto, rejeitamos a hipótese nula, ou seja, pelo menos uma das médias é considerada diferente. Para saber quais médias são diferentes, realize um teste de comparações múltiplas.</p>
</section>
</section>
<section id="teste-de-shapiro-wilk" class="level1">
<h1>Teste de Shapiro-Wilk</h1>
<p>Utiliza-se o teste de Shapiro-Wilk para verificar se uma amostra é proveniente de uma população com distribuição normal. O teste avalia (ou verifica) as seguintes hipóteses:</p>
<p><span class="math inline">\(H_{0}\)</span> : Os dados são provenientes de uma distribuição Normal</p>
<p>vs</p>
<p><span class="math inline">\(H_{1}\)</span> : os dados não são provenientes de uma distribuição Normal.</p>
<p>Para realizar o teste de Shapiro-Wilk utilizamos a função <code>shapiro</code> da biblioteca Scipy, cujo único argumento de entrada é:</p>
<ul>
<li>x : a amostra observada.</li>
</ul>
<p>Para mais informações clique aqui para acessar a documentação da função.</p>
<section id="exemplo-2" class="level2">
<h2 class="anchored" data-anchor-id="exemplo-2">Exemplo</h2>
<p>Deseja-se saber se as avaliações da audiência constada no site Rotten Tomatoes para os filmes de <strong>Aventura</strong> são provenientes de uma <code>distribuição normal</code>, utilizando um nível de significância de <code>5%</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>ss.shapiro(df_adventure[<span class="st">'Audience Ratings %'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>(0.9456037282943726, 0.14058126509189606)</p>
</div>
</div>
</div>
<p>Como p-valor=0.14 é maior que o nível de significância proposto, não rejeitamos a hipótese nula, ou seja, podemos afirmar que a amostra é proveniente de uma população com distribuição normal.</p>
</section>
</section>
<section id="teste-de-kolmogorovsmirnov" class="level1">
<h1>Teste de Kolmogorov–Smirnov</h1>
<p>O teste Kolmogorov–Smirnov é um teste não paramétrico sobre a igualdade de distribuições de probabilidade contínuas e unidimensionais que pode ser usado para comparar uma amostra com uma distribuição de probabilidade de referência ou duas amostras uma com a outra. Dado isso, podemos ter as seguintes hipóteses:</p>
<p><span class="math inline">\(H_{0}\)</span> : os dados seguem uma certa distribuição</p>
<p>vs</p>
<p><span class="math inline">\(H_{1}\)</span> : os dados não seguem uma certa distribuição</p>
<p>Ou</p>
<p><span class="math inline">\(H_{0}\)</span> : as duas amostras seguem a mesma distribuição</p>
<p>vs</p>
<p><span class="math inline">\(H_{1}\)</span> : as duas amostram não seguem a mesma distribuição</p>
<p>Para realizar o teste de Kolmogorov-Smirnov para uma amostra utilizamos a função <code>kstest</code> da biblioteca <strong>Scipy</strong>, cujos argumentos de entrada são:</p>
<ul>
<li><code>rvs</code>: a amostra observada.</li>
<li><code>cdf</code>: o nome da distribuição: “norm”,”expon”, …</li>
<li><code>args</code>: parâmetros da distribuição.</li>
</ul>
<p>Para mais informações sobre essa função clique aqui.</p>
<p>Para realizar o teste de Kolmogorov-Smirnov para duas amostras utilizamos a função <code>ks_2sample</code> da biblioteca Scipy, cujos argumentos principais são:</p>
<ul>
<li>data1: primeira amostra observada.</li>
<li>data2: segunda amostra observada.</li>
</ul>
<p>E sobre essa função, clique aqui.</p>
<p>Agora vamos aplicá-las em alguns exemplos.</p>
<section id="exemplo-1-1" class="level2">
<h2 class="anchored" data-anchor-id="exemplo-1-1">Exemplo 1</h2>
<p>Deseja-se verificar se as avaliações da audiência constada no site Rotten Tomatoes para os filmes de Terror são provenientes de uma distribuição normal, utilizando um nível de significância de 5%.</p>
<p><span class="math inline">\(H_{0}\)</span>: os dados seguem uma distribuição normal</p>
<p>vs</p>
<p><span class="math inline">\(H_{1}\)</span>: os dados não seguem uma distribuição normal</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df_horror <span class="op">=</span> df[df[<span class="st">"Genre"</span>] <span class="op">==</span> <span class="st">'Horror'</span>]</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>df_horror.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="dataframe table-striped table-bordered table-sm table small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Film</th>
<th data-quarto-table-cell-role="th">Genre</th>
<th data-quarto-table-cell-role="th">Rotten Tomatoes Ratings %</th>
<th data-quarto-table-cell-role="th">Audience Ratings %</th>
<th data-quarto-table-cell-role="th">Budget (million $)</th>
<th data-quarto-table-cell-role="th">Year of release</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>30 Days of Night</td>
<td>Horror</td>
<td>50</td>
<td>57</td>
<td>32</td>
<td>2007</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>A Nightmare on Elm Street</td>
<td>Horror</td>
<td>13</td>
<td>40</td>
<td>35</td>
<td>2010</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>Alien vs. Predator -- Requiem</td>
<td>Horror</td>
<td>14</td>
<td>37</td>
<td>40</td>
<td>2007</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">28</td>
<td>Apollo 18</td>
<td>Horror</td>
<td>23</td>
<td>31</td>
<td>5</td>
<td>2011</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">59</td>
<td>Case 39</td>
<td>Horror</td>
<td>23</td>
<td>42</td>
<td>26</td>
<td>2009</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>ss.kstest(df_horror[<span class="st">'Audience Ratings %'</span>], <span class="st">"norm"</span>, args<span class="op">=</span>[np.mean(df_horror[<span class="st">'Audience Ratings %'</span>]),np.std(df_horror[<span class="st">'Audience Ratings %'</span>])])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>KstestResult(statistic=0.05351444278807435, pvalue=0.9989829445848811)</p>
</div>
</div>
</div>
<p>Como p-valor = 0.99 é maior que o nível de significância proposto, não rejeitamos a hipótese nula, ou seja, há evidências de que os dados são provenientes de uma normal.</p>
</section>
<section id="exemplo-2-1" class="level2">
<h2 class="anchored" data-anchor-id="exemplo-2-1">Exemplo 2</h2>
<p>Deseja-se verificar se as avaliações da audiência constadas no site Rotten Tomatoes para os filmes de <strong>Terror</strong> possuem a <strong>mesma distribuição</strong> do que as avaliações da audiência para os filmes de <strong>Ação</strong>, utilizando um nível de significância de <code>5%</code>.</p>
<p><span class="math inline">\(H_{0}\)</span>: os dados seguem a mesma distribuição.</p>
<p>vs</p>
<p><span class="math inline">\(H_{1}\)</span>: os dados não seguem a mesma distribuição.</p>
<p>Como p-valor=0.004 é menor que o nível de significância proposto, rejeitamos a hipótese nula, ou seja, as avaliações da audiência para os filmes de Terror e Ação não seguem a mesma distribuição.</p>
</section>
</section>
<section id="análise-sobre-dados-categóricos" class="level1">
<h1>Análise sobre Dados Categóricos</h1>
<section id="teste-de-aderência" class="level2">
<h2 class="anchored" data-anchor-id="teste-de-aderência">Teste de Aderência</h2>
<p>O teste de Aderência busca avaliar o comportamento, em uma população, de uma variável categórica que pode assumir k valores. Sejam <span class="math inline">\(p_{1}, p_{2}, p_{3},…, p_{k}\)</span>, respectivamente, as proporções populacionais das categorias <span class="math inline">\(1, 2, 3, …, K\)</span>, teremos as seguintes hipóteses:</p>
<p><span class="math inline">\(H_{0} : p_{1} = p_{1,A} \ , \ p_{2} = p_{2,A} \ , \ p_{3} = p_{3,A} \ … \ p_{k} = p_{k,A}\)</span></p>
<p>vs</p>
<p>$H_{1} : p_{i} p_{i,A} &nbsp;, $, para pelo menos um <span class="math inline">\(i \ , \ i = 1, 2, 3, …, k\)</span></p>
<p>Onde <span class="math inline">\(p_{i,A}; i = 1, 2, · · · , k\)</span> são as proporções da hipótese nula, que devem satisfazer <span class="math inline">\(\sum\limits_{i = 1}^k p_{i,A} = 1\)</span></p>
<p>Sob <span class="math inline">\(H_{0}\)</span>:</p>
<p><span class="math inline">\(X^2 = \sum_{i = 1}^{k}\frac{(o_{i} - e_{i})^2}{e_{i}} \sim X^2_{k-1}\)</span></p>
<p>Onde:</p>
<ul>
<li><span class="math inline">\(o_{i}\)</span>: é o número de vezes que a categoria <span class="math inline">\(i\)</span> é observada na amostra</li>
<li><span class="math inline">\(e_{i}\)</span>: valor esperado; obtido pela multiplicação do tamanho da amostra com <span class="math inline">\(p_{i}\)</span></li>
</ul>
<p>E o p-valor é calculado da seguinte forma:</p>
<p>Para o teste de Aderência usaremos a função <code>chisquare</code> da biblioteca <strong>Scipy</strong>, cujos argumentos de entrada são</p>
<ul>
<li><code>f_obs</code>: amostra observada</li>
<li><code>f_exp</code>: valores esperados, sob <span class="math inline">\(H_{0}\)</span></li>
</ul>
<p>Para mais informações sobre a função clique aqui para acessar sua documentação.</p>
<section id="exemplo-3" class="level3">
<h3 class="anchored" data-anchor-id="exemplo-3">Exemplo</h3>
<p>Deseja-se verificar se a proporção de filmes de <strong>Aventura</strong>, <strong>Romance</strong> e <strong>Suspense</strong> avaliados são, respectivamente, <code>0.26</code>, <code>0.29</code>, <code>0.45</code>, ao nível de significância de <code>5%</code>.</p>
<p><span class="math inline">\(H_{0} : p_{1} = 0.26 \ , \ p_{2} = 0.29 \ , \ p_{3} = 0.45\)</span></p>
<p>vs</p>
<p>$H_{1} : p_{i} p_{i,A} &nbsp;, $, para pelo menos um <span class="math inline">\(i \ , \ i = 1, 2, 3\)</span></p>
<p>Obtendo os valores observados:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>tabela_freq <span class="op">=</span> df.Genre.value_counts()</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>tabela_freq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Comedy 172 Action 154 Drama 101 Horror 49 Thriller 36 Adventure 29 Romance 21 Name: Genre, dtype: int64</p>
</div>
</div>
</div>
<p>Aplicando a função:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>obs <span class="op">=</span> [tabela_freq[<span class="dv">5</span>], tabela_freq[<span class="dv">6</span>], tabela_freq[<span class="dv">4</span>]]</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>total_obs <span class="op">=</span> <span class="bu">sum</span>(obs)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>chisquare(f_obs <span class="op">=</span> obs, f_exp <span class="op">=</span> [<span class="fl">0.26</span><span class="op">*</span>total_obs, <span class="fl">0.29</span><span class="op">*</span>total_obs, <span class="fl">0.45</span><span class="op">*</span>total_obs])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Power_divergenceResult(statistic=2.782616741718586, pvalue=0.24874963485619836)</p>
</div>
</div>
</div>
<p>Como p-valor=0.25 é maior que o nível de significância proposto, não rejeitamos a hipótese nula, ou seja, podemos afirmar que a proporção de filmes de Aventura, Romance e Suspense avaliados são respectivamente de 0.26,0.29 e 0.45.</p>
</section>
</section>
<section id="teste-de-homogeneidade" class="level2">
<h2 class="anchored" data-anchor-id="teste-de-homogeneidade">Teste de Homogeneidade</h2>
<p>Esse caso é similar ao teste de Aderência, com a diferença de que agora será avaliado o comportamento, em C populações <strong>independentes</strong>, de uma variável categórica que pode assumir L valores.</p>
<p>Para este teste, teremos as seguintes hipóteses:</p>
<p><span class="math inline">\(H_{0} : p_{1, 1} = p_{1, 2} = … = p_{1, C} \ ; \ p_{2, 1} = p_{2, 2} = … = p_{2, C} \ ; \ \ … \ \ ; \ p_{L, 1} = p_{L, 2} = … = p_{L, C}\)</span></p>
<p>vs</p>
<p><span class="math inline">\(H_{1} :\)</span> pelo menos uma das igualdades não é valida</p>
<p>Para temos que:</p>
<p><span class="math inline">\(X^2 = \sum_{i = 1}^{L}\sum_{j = 1}^{C}\frac{(o_{ij - e_{ij}})^2}{e_{ij}} \sim X^2_{(L - 1)*(C - 1)}\)</span></p>
<p>Onde:</p>
<ul>
<li><span class="math inline">\(o_{ij} :\)</span> número de vezes que na amostra da população <span class="math inline">\(i\)</span> a categoria <span class="math inline">\(j\)</span> é observada.</li>
<li><span class="math inline">\(e_{ij} :\)</span> valor esperado na população e na categoria <span class="math inline">\(j\)</span></li>
</ul>
<p>E o p-valor é calculado da seguinte forma:</p>
<p>Para o teste de Homogeneidade usaremos a função <code>chi2_contingency</code> da biblioteca <strong>Scipy</strong>, cujo argumento de entrada é</p>
<ul>
<li><code>observed</code>: tabela de contingência</li>
</ul>
<section id="exemplo-4" class="level3">
<h3 class="anchored" data-anchor-id="exemplo-4">Exemplo</h3>
<p>Com o intuito de saber a eficacia da quimioterapia para dois diferentes tipos de câncer, um médico selecionou de maneira aleatória 100 pacientes com o câncer do Tipo I e 100 com o Tipo II, e dispôs os resultados na tabela abaixo. Verifique se existe relação entre a eficacia da quimioterapia e o tipo de câncer, ao nível de significância de <code>5%</code>.</p>

<table class="table-striped table-bordered table-sm">
<thead>
  <tr>
    <th></th>
    <th></th>
    <th>Reação</th>
    <th></th>
  </tr>
</thead>
<tbody>
  </tbody><thead>
  <tr>
    <td><b>Câncer</b></td>
    <td>Pouca</td>
    <td>Média</td>
    <td>Alta</td>
  </tr>
  </thead>
  <tbody><tr>
    <td>Tipo I</td>
    <td>51</td>
    <td>33</td>
    <td>16</td>
  </tr>
  </tbody><thead>
  <tr>
    <td>Tipo II</td>
    <td>58</td>
    <td>29</td>
    <td>13</td>
  </tr>
  </thead>

</table>
<div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>tabela_cancer <span class="op">=</span> np.array([<span class="dv">51</span>, <span class="dv">33</span>, <span class="dv">16</span>, <span class="dv">58</span>, <span class="dv">29</span>, <span class="dv">13</span>]).reshape(<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>tabela_cancer</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>array([[51, 33, 16],[58, 29, 13]])</p>
</div>
</div>
</div>
<div class="sourceCode" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>chi2_contingency(tabela_cancer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>(1.0179506281189088, 0.6011112135514984, 2, array([[54.5, 31. , 14.5],[54.5, 31. , 14.5]]))</p>
</div>
</div>
</div>
<p>Como p-valor = 0.6011 é maior que o nível de significância, não rejeitamos a hipótese nula. Ou seja, há evidências de que o efeito da quimioterapia é igual para os dois tipos de câncer observados.</p>
</section>
</section>
<section id="teste-de-independência" class="level2">
<h2 class="anchored" data-anchor-id="teste-de-independência">Teste de Independência</h2>
<p>Agora considere que cada indivíduo da amostra será classificado conforme duas variáveis qualitativas. Em comparação ao teste de Homogeneidade, e simplificando o entendimento, ao invés de L populações, teremos uma população que pode ser classificada de Lformas diferentes.</p>
<p>Para este teste teremos as seguintes hipóteses:</p>
<p><span class="math inline">\(H_{0} : p_{i\bigcap j} = p_{i.}*p_{.j}\)</span>, para todo <span class="math inline">\(i = 1, …, L\)</span> e <span class="math inline">\(j = 1, …, C\)</span></p>
<p>vs</p>
<p><span class="math inline">\(H_{1} :\)</span> pelo menos uma das igualdades não é valida</p>
<p>Onde <span class="math inline">\(p_{i\bigcap j}\)</span> é a probabilidade do indivíduo ser classificado como <span class="math inline">\(i\)</span> e <span class="math inline">\(j\)</span> simultaneamente e <span class="math inline">\(p_{i.}\)</span> e <span class="math inline">\(p_{.j}\)</span> as probabilidades dos indivíduos serem classificados como <span class="math inline">\(i\)</span> ou <span class="math inline">\(j\)</span> de forma separada, respectivamente.</p>
<p>Para e sob temos que:</p>
<p><span class="math inline">\(X^2 = \sum_{i = 1}^{L}\sum_{j = 1}^{C}\frac{(o_{ij - e_{ij}})^2}{e_{ij}} \sim X^2_{(L - 1)*(C - 1)}\)</span></p>
<p>E o p-valor é calculado da seguinte forma:</p>
<p>Todo desenvolvimento do cálculo será igual ao teste de Homogeneidade, mas a interpretação do problema será diferente, assim como as hipóteses.</p>
<section id="exemplo-5" class="level3">
<h3 class="anchored" data-anchor-id="exemplo-5">Exemplo</h3>
<p>Agora, o médico gostaria de avaliar se a reação à quimioterapia independe do tipo de câncer do paciente. Para tanto, foram selecionados 180 pacientes que fazem tratamento de câncer com quimioterapia e suas informações foram dispostas na tabela abaixo. Verifique se “Tipo de câncer” e “Eficacia da quimioterapia” são variáveis independentes, ao nível de significância de <code>5%</code>.</p>

<table class="table-striped table-bordered table-sm">
<thead>
  <tr>
    <th></th>
    <th></th>
    <th>Reação</th>
    <th></th>
  </tr>
</thead>
<tbody>
  </tbody><thead>
  <tr>
    <td><b>Câncer</b></td>
    <td>Pouca</td>
    <td>Média</td>
    <td>Alta</td>
  </tr>
  </thead>

<tbody>
  <tr>
    <td>Tipo III</td>
    <td>38</td>
    <td>32</td>
    <td>30</td>
  </tr>
  <tr>
    <td>Tipo IV</td>
    <td>26</td>
    <td>38</td>
    <td>16</td>
  </tr>
</tbody>
</table>
<div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>tabela_cancer <span class="op">=</span> np.array([<span class="dv">38</span>, <span class="dv">32</span>, <span class="dv">30</span>, <span class="dv">26</span>, <span class="dv">38</span>, <span class="dv">16</span>]).reshape(<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>tabela_cancer</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>array([[38, 32, 30],[26, 38, 16]])</p>
</div>
</div>
</div>
<div class="sourceCode" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>chi2_contingency(tabela_cancer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>(4.862969720496892, 0.08790620719349594, 2, array([[35.55555556, 38.88888889, 25.55555556], [28.44444444, 31.11111111, 20.44444444]]))</p>
</div>
</div>
</div>
<p>Como p-valor = 0.0879 é maior que o nível de significância, não rejeitamos a hipótese nula. Ou seja, há evidências de que “Tipo de câncer” e “Eficacia da quimioterapia” são variáveis independentes.</p>
</section>
</section>
</section>
<section id="referências" class="level1">
<h1>Referências</h1>
<ul>
<li>Casella, G. e Berger, R. L. <strong>Inferência estatística</strong>. Cengage Learning, 2010.</li>
<li>Pauli Virtanen, Ralf Gommers, Travis E. Oliphant, Matt Haberland, Tyler Reddy, David Cournapeau, Evgeni Burovski, Pearu Peterson, Warren Weckesser, Jonathan Bright, Stéfan J. van der Walt, Matthew Brett, Joshua Wilson, K. Jarrod Millman, Nikolay Mayorov, Andrew R. J. Nelson, Eric Jones, Robert Kern, Eric Larson, CJ Carey, İlhan Polat, Yu Feng, Eric W. Moore, Jake VanderPlas, Denis Laxalde, Josef Perktold, Robert Cimrman, Ian Henriksen, E.A. Quintero, Charles R Harris, Anne M. Archibald, Antônio H. Ribeiro, Fabian Pedregosa, Paul van Mulbregt, and SciPy 1.0 Contributors. (2020) <strong>SciPy 1.0: Fundamental Algorithms for Scientific Computing in Python.</strong> Nature Methods, in press.</li>
<li>Seabold, Skipper, and Josef Perktold. <strong>“statsmodels: Econometric and statistical modeling with python.”</strong> Proceedings of the 9th Python in Science Conference, 2010.</li>
<li>Stéfan van der Walt, S. Chris Colbert and Gaël Varoquaux. <strong>The NumPy Array: A Structure for Efficient Numerical Computation, Computing in Science &amp; Engineering</strong>, 2011.</li>
<li>John D. Hunter. <strong>Matplotlib: A 2D Graphics Environment, Computing in Science &amp; Engineering</strong>, 2007.</li>
<li>Wes McKinney. <strong>Data Structures for Statistical Computing in Python, Proceedings of the 9th Python in Science Conference</strong>, 2010.</li>
<li>Velarde, L. G. C. CAVALIERE, Y. F. <strong>Apostila Inferência Estatística. Departamento de Estatística</strong>. Universidade Federal Fluminense</li>
<li>FARIAS, A. M. L. <strong>Apostila de Estatística II</strong>. Departamento de Estatística. 2017. Universidade Federal Fluminense.</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./TesteDeHipotesesParte1.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Teste de Hipóteses - Parte 1</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Criação: Maqueise Pinheiro e Thaís Machado. <br> Orientação: Douglas Rodrigues (UFF) e Karina Yaginuma (UFF). <br> Colaboradores: Gabriel Miranda e Thiago Augusto.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>